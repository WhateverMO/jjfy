基于模块的评分系统实现了一个分层评估框架，通过多级加权聚合方法计算数据成熟度分数。该系统处理问卷回复，应用权重计算方法，并在三个分层级别上生成综合评分结构。

## 系统架构

评分系统采用三层分层结构，分数从 Level 3（最细粒度）向上流动，经过 Level 2 到达 Level 1（最聚合），最终生成模型总分。

![[Pasted image 20251104170226.png]]

## 核心组件

### 分数计算引擎

主要的评分逻辑在 [`model_score_cal_main.py`](/data-maturity-assessment/back/eval/model_score_cal_main.py) 中实现，其中包含了分层分数聚合的核心数学函数：

1.  **Level 3 处理**：[`multiply_weights_scores_l3()`](/data-maturity-assessment/back/eval/model_score_cal_main.py#L13-L47) 函数处理最细粒度指标的初始加权计算，在权重乘法之前对原始分数应用映射函数。
    
2.  **更高级别处理**：[`multiply_weights_scores()`](/data-maturity-assessment/back/eval/model_score_cal_main.py#L50-L84) 函数使用标准加权聚合处理 Level 2 和 Level 1 计算，不进行映射。
    
3.  **结构管理**：[`split_list_at_indices()`](/data-maturity-assessment/back/eval/model_score_cal_main.py#L87-L123) 函数根据预定义的模块边界分割聚合分数，管理分层结构。
    

### 主评分流程

[`calculate_model_score()`](/data-maturity-assessment/back/eval/model_score_cal_main.py#L125-L159) 函数协调整个评分过程：

![[Pasted image 20251104170250.png]]

该函数执行四步流程：

1.  使用映射函数计算 Level 3 加权分数
2.  根据 Level 2 模块结构分割分数
3.  计算 Level 2 加权分数
4.  计算最终 Level 1 加权分数以生成模型分数

### 与评估流程的集成

评分系统通过 [`eval.py`](/data-maturity-assessment/back/eval/eval.py) 中的 [`eval_qa()`](/data-maturity-assessment/back/eval/eval.py#L33-L157) 函数与更广泛的评估框架集成，该函数协调：

-   问卷处理和权重计算（步骤 1-3）
-   从问卷回复中推导分数（步骤 4）
-   分层分数计算（步骤 5）
-   结构化输出生成（步骤 6）

## 数据结构生成

系统通过 [`build_score_structure()`](/data-maturity-assessment/back/eval/generate_dict_main.py#L163-L233) 函数生成综合评分结构，创建包含以下内容的嵌套字典：

-   **分层分数**：每个级别的分数，适当四舍五入到小数点后 4 位
-   **权重信息**：所有级别每个指标对应的权重
-   **模块组织**：反映数据成熟度框架结构的适当嵌套
-   **元数据**：总分和成熟度级别分类

## 模块配置

系统支持八个主要数据成熟度模块，定义在 [`generate_dict_main.py`](/data-maturity-assessment/back/eval/generate_dict_main.py#L66-L68) 中：

1.  **数据战略** (Data Strategy)
2.  **数据生命周期** (Data Lifecycle)
3.  **数据治理** (Data Governance)
4.  **数据架构** (Data Architecture)
5.  **数据质量** (Data Quality)
6.  **数据标准** (Data Standards)
7.  **数据安全** (Data Security)
8.  **数据应用** (Data Application)

每个模块包含多个 Level 2 和 Level 3 子指标，整个框架共有 25 个 Level 2 指标和 57 个 Level 3 指标。

## 评分特性

### 数学特性

-   **精度**：所有计算保持 4 位小数精度以确保一致性
-   **验证**：全面的输入验证确保权重和分数之间的维度一致性
-   **错误处理**：对不匹配的维度和无效输入进行健壮的错误检查

### 输出格式

系统生成适用于以下场景的结构化输出：

-   通过 Django 后端进行 API 集成
-   用于前端消费的 JSON 序列化
-   带有分层分解的详细报告
-   跨不同评估方法的比较分析

## 实现说明

> [!NOTE]
> 评分系统支持 BWM（最优最差法）和熵权法进行权重计算，通过评估流程中的 `method` 参数提供评估方法的灵活性。

> [!NOTE]
> 分层结构通过仔细的索引管理得以维持，`split_list_at_indices()` 函数确保权重、分数和模块边界在所有三个级别之间的适当对齐。

基于模块的评分系统为数据成熟度评估提供了坚实的基础，将数学严谨性与灵活配置相结合，以支持各种评估场景和组织需求。

要深入了解输入此评分系统的权重计算方法，请参考 [权重计算算法](深入探讨/核心评估引擎/权重计算方法) 和 [BWM 方法实现](深入探讨/权重计算方法/BWM方法实现) 。