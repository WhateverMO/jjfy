熵权法是一种数据驱动的权重计算技术，根据评价指标的信息含量确定其重要性。该方法为具有更强区分能力和较低熵值的指标分配更高权重，使其在客观多准则决策场景中特别有价值。

## 数学基础

熵权法基于以下原理：数值变异性更大的指标包含更多信息，因此应获得更高权重。该过程遵循以下数学步骤：

## 核心实现

主要熵权法实现通过 [weight\_calc\_method.py](/data-maturity-assessment/back/eval/weight_calc_method.py#L196-L229) 中的 `entropy_method()` 函数提供。该函数作为熵权计算的统一接口：

```python
def entropy_method(data_matrix):
    """
    熵权法确权方法 - 统一接口
    参数: data_matrix - list[list]，决策矩阵，行代表方案，列代表指标
    返回: (权重向量, 附加信息)
    """
```

该函数接受决策矩阵，其中行代表备选方案，列代表评价指标，返回权重向量以及包括熵值和信息效用度量的附加诊断信息。

## 分步算法

### 1\. 数据归一化

第一步使用最小-最大归一化对每列进行归一化以消除尺度差异 [weight\_calc\_method.py](/data-maturity-assessment/back/eval/weight_calc_method.py#L231-L239)：

```python
def _normalize_columns(matrix):
    """对每一列进行归一化：r_ij = (x_ij - min(x_j)) / (max(x_j) - min(x_j))"""
```

通过将数值缩放到 \[0,1\] 范围确保所有指标可比，并对所有值相同的列进行特殊处理。

### 2\. 比例矩阵计算

接下来，该方法计算每个归一化值在其列中的比例 [weight\_calc\_method.py](/data-maturity-assessment/back/eval/weight_calc_method.py#L241-L247)：

```python
def _calculate_proportion(normalized_matrix):
    """计算每个元素在列中的占比：p_ij = r_ij / sum(r_j)"""
```

此步骤将归一化矩阵转换为概率分布，其中每列和为 1。

### 3\. 熵值计算

使用香农熵公式计算每个指标的信息熵 [weight\_calc\_method.py](/data-maturity-assessment/back/eval/weight_calc_method.py#L249-L256)：

```python
def _calculate_entropy(proportion_matrix):
    """计算每一列的信息熵"""
    m = proportion_matrix.shape[0]      epsilon = 1e-10  # 避免log2(0)
    modified_p = np.where(proportion_matrix == 0, epsilon, proportion_matrix)
    entropy = -np.sum(proportion_matrix * np.log2(modified_p), axis=0) / np.log2(m)
```

熵值范围从 0 到 1，其中较低熵表示更高信息含量和区分能力。

### 4\. 权重确定

最后，基于信息效用度计算权重 [weight\_calc\_method.py](/data-maturity-assessment/back/eval/weight_calc_method.py#L258-L263)：

```python
def _calculate_entropy_weights(entropy):
    """计算权重：w_j = (1 - e_j) / sum(1 - e_j)"""
    d_j = 1 - entropy  # 信息效用值
    sum_d = d_j.sum()
    weights = d_j / sum_d
    return weights
```

具有较低熵的指标获得更高权重，反映其对决策的更大贡献。

## 与评估流水线集成

熵权法通过 [weight\_calc\_method\_main.py](/data-maturity-assessment/back/eval/weight_calc_method_main.py#L11-L49) 中的 `process_weight_list()` 函数与更广泛的评估系统无缝集成。该函数处理多个数据集的批处理：

```python
elif method == "entropy":
    entropy_weights, info = entropy_method(a_level_data_converted)
    result_list.append(entropy_weights)
```

系统支持处理分层数据结构，其中每个顶级元素代表独立的评估场景。

## 实际应用背景

在数据成熟度评估框架中，熵权法特别适用于：

-   **客观权重分配**：在指标重要性确定中消除主观偏见
-   **多专家聚合**：结合多个利益相关者或专家的评估
-   **动态权重调整**：根据实际数据特征而非预设偏好调整权重

> [!NOTE]
> 熵权法通过 epsilon 替换和范围归一化自动处理零值和相同指标等边缘情况，确保在实际应用中的数值稳定性。

## 输出结构

该方法返回包含以下内容的综合结果集：

| 组件 | 描述 | 用途 |
| --- | --- | --- |
| 权重向量 | 和为 1 的归一化权重 | 直接用于评分计算 |
| 熵值 | 每个指标的信息含量 | 诊断分析 |
| 信息效用 | 熵的补数 (1-e) | 权重计算基础 |
| 归一化矩阵 | 预处理数据 | 透明度和调试 |

## 使用示例

在你的评估流水线中应用熵权法：

```python
from back.eval.weight_calc_method import entropy_method
 
# 输入：决策矩阵（备选方案 × 指标）
data_matrix = [
    [3.2, 4.5, 2.1],  # 备选方案 1
    [2.8, 3.9, 3.7],  # 备选方案 2
    [4.1, 2.3, 3.2]   # 备选方案 3
]
 
weights, additional_info = entropy_method(data_matrix)
# weights: [0.342, 0.287, 0.371]
```

所得权重可通过 [权重聚合策略](深入探讨/权重计算方法/权重聚合策略) 页面直接与 BWM 等其他评估方法集成。

## 后续步骤

要在你的评估系统中进行全面权重计算，建议探索：

-   [BWM 方法实现](深入探讨/权重计算方法/BWM方法实现) \- 基于专家比较的主观权重确定
-   [权重聚合策略](深入探讨/权重计算方法/权重聚合策略) \- 结合多种权重计算方法
-   [评估流水线架构](深入探讨/核心评估引擎/评估流水线架构) \- 理解完整评估工作流

熵权法为客观指标加权提供了稳健基础，补充主观方法以创建平衡且可辩护的评估框架。