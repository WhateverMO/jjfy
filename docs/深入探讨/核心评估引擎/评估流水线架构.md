评估管道是一个综合性的六阶段系统，通过分层权重计算和分数聚合，将问卷数据处理成数据成熟度评估分数。该架构采用多级评分系统，将原始问卷响应转换为结构化的成熟度评估结果。

## 管道概述

评估管道遵循系统性的六步流程，将问卷数据转化为全面的成熟度评估分数：

![[Pasted image 20251104163703.png]]
## 核心管道阶段

### 阶段1：问卷数据准备

管道首先通过随机拆分处理问卷计数，以确保统计稳健性。`split_questionnaire_counts_random()`函数将问卷数据划分为多个子集，使用固定种子确保可重现性\[eval.py#L44-L48\]。此阶段通过创建代表同一问卷响应不同视角的多个数据样本，为权重计算做好准备。

### 阶段2：独立权重计算

每个拆分的问卷子集使用`calculate_weights()`函数进行独立权重计算\[eval.py#L52-L53\]。结果随后通过`transpose_by_section()`按章节进行转置\[eval.py#L56-L57\]，将权重从以问卷为中心的视图重组为以章节为中心的视图，从而实现跨问卷权重聚合和比较。

### 阶段3：权重处理与聚合

转置后的权重通过`process_weight_list()`函数使用BWM（最佳最差法）或熵权法进行处理\[eval.py#L62-L63\]。此阶段应用数学算法，基于聚合的问卷响应确定最优权重分布。然后使用章节索引将权重拆分为分层级别（L1、L2、L3）\[eval.py#L66-L68\]。

### 阶段4：问卷2分数计算

与权重处理并行，管道使用`calculate_final_scores()`从第二份问卷计算分数\[eval.py#L75-L77\]。此函数处理问卷响应以生成最细粒度级别（3级指标）的实际绩效分数，然后根据与权重相同的章节结构进行拆分。

### 阶段5：分层分数聚合

`calculate_model_score()`函数通过层次结构聚合分数执行核心数学计算\[model\_score\_cal\_main.py#L125-L164\]：

1.  **3级加权评分**：应用映射函数和权重乘法，从3级指标计算2级分数
2.  **2级加权评分**：使用2级权重将2级分数聚合计算1级分数
3.  **最终模型评分**：通过应用1级权重到1级分数计算整体模型分数

### 阶段6：结果结构化与输出

最后阶段使用`build_score_structure()`创建包含所有分层分数、权重和最终模型分数的综合字典\[eval.py#L95-L102\]。此结构化输出在每个分层级别提供评估结果的完整可见性，支持详细分析和报告。

## 数据流架构

管道处理两种不同的问卷类型：

| 组件 | 输入 | 输出 | 用途 |
| --- | --- | --- | --- |
| 问卷1处理 | 权重问卷计数 | 分层权重 | 确定指标的相对重要性 |
| 问卷2处理 | 绩效问卷计数 | 绩效分数 | 测量实际能力水平 |
| 分数聚合 | 权重 + 分数 | 最终成熟度分数 | 结合重要性和绩效 |

## 关键集成点

评估管道集成了多个专业模块：

-   **权重工具**：处理问卷拆分和权重计算[weight\_utils.py](/data-maturity-assessment/back/eval/weight_utils.py)
-   **权重计算方法**：实现BWM和熵权算法[weight\_calc\_method\_main.py](/data-maturity-assessment/back/eval/weight_calc_method_main.py#L11)
-   **分数计算**：将问卷响应处理为分数[question\_2.py](/data-maturity-assessment/back/eval/question_2.py)
-   **模型评分**：执行分层分数聚合[model\_score\_cal\_main.py](/data-maturity-assessment/back/eval/model_score_cal_main.py#L125)
-   **结果生成**：创建结构化输出字典[generate\_dict\_main.py](/data-maturity-assessment/back/eval/generate_dict_main.py#L163)

> [!NOTE]
> 管道使用固定种子（42）进行问卷拆分，以确保多次评估运行的结果可重现，这对于一致的成熟度评估至关重要。

## 方法选择与配置

管道支持两种权重计算方法，可通过`method`参数选择：

-   **BWM方法**：使用成对比较基于最佳最差标准确定权重
-   **熵权法**：基于信息熵和数据离散度计算权重

方法的选择会影响权重分布，进而影响最终成熟度分数，为不同评估场景提供了灵活性。

> [!NOTE]
> 分层结构支持8个1级指标、23个2级指标和72个3级指标，提供数据成熟度维度的全面覆盖。

## 后续步骤

要了解特定管道组件的详细实现，请探索：

-   [问卷处理方法](深入探讨/核心评估引擎/问卷处理方法) 了解数据准备详情
-   [权重计算算法](深入探讨/核心评估引擎/权重计算方法) 了解数学基础
-   [分数计算方法](深入探讨/数据处理工具/评分计算方法) 了解绩效评估逻辑