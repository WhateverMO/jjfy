问卷处理方法组件是数据成熟度评估系统的核心评估引擎。该模块通过复杂算法处理问卷回答、计算模块得分，并采用结构化多层级评估框架将原始调查数据转化为有意义的成熟度指标。

## 核心架构概览

问卷处理系统通过三层架构运行，处理不同类型的问题和评估方法：

![[Pasted image 20251104164022.png]]

## 问题分类与处理

### 单选题处理

单选题采用比例评分机制处理，其中每个选项代表不同的成熟度级别。系统根据响应在可用选项中的分布情况计算得分：

-   **输入格式**：表示每个选项响应计数的2元素数组 `[选项1计数, 选项2计数]`
-   **评分逻辑**：`score = base_score * (positive_option_count / total_responses)` \[question\_2.py#L33-L35\]
-   **验证**：系统验证单选题恰好有2个选项，并从最大响应计数计算总表单数

### 多选题处理

多选题采用分布式评分方法，考虑所有受访者选择的选项总数：

-   **输入格式**：可变长度数组 `[选项1计数, 选项2计数, ..., 选项N计数]`
-   **评分逻辑**：`score = (base_score * (total_selections / option_count)) / total_forms` \[question\_2.py#L36-L38\]
-   **标准化**：通过可用选项数对得分进行标准化，确保公平比较

## 基于模块的问题分组

系统实现了精密的模块分组策略，将问题组织为逻辑评估单元：

### 动态分区配置

问题使用`SECTION_INDICES`配置分组为模块，支持多种分组模式：

| 模块类型 | 问题范围 | 分组模式 | 示例 |
| --- | --- | --- | --- |
| 标准3题 | 1-45 | 3题一组 | `[[0,1,2], [3,4,5], ...]` |
| 单独问题 | 46-62 | 单问题模块 | `[[45], [46], [47], ...]` |
| 特殊模块 | 63+ | 自定义分组 | `[[62,67,65], [63,66], ...]` |
| 后期3题组 | 80-121 | 3题一组 | `[[79,80,81], [82,83,84], ...]` |

> [!NOTE]
> 分区索引使用从零开始的索引，因此问卷中的第63题对应代码中的索引62。配置模块分组时必须仔细处理此偏移量。

### 模块得分计算

每个模块获得标准化的总分（默认100分），在其组成问题间平均分配：

````python
base_score = module_total / count
 
`calculate_final_scores`函数同时处理所有模块，返回单个问题得分和聚合模块总分 [question_2.py#L3-L11]。
 
## 与权重计算方法的集成
 
问卷处理系统与权重计算方法无缝集成，生成全面的成熟度评估：
 
### 评估流程
 
1. **问卷拆分**：原始响应被随机拆分以进行权重计算验证 [eval.py#L44]
2. **权重计算**：使用BWM或熵方法计算模块权重 [eval.py#L47-48]
3. **得分应用**：计算的权重应用于问卷得分 [eval.py#L80-85]
4. **层级聚合**：得分通过三个层级（L1→L2→L3）聚合 [model_score_cal_main.py#L125]
 
### 多层级评分系统
 
系统支持三级层次化评分结构：
 
- **第3级**：模块内的单个问题得分
- **第2级**：模块级聚合得分  
- **第1级**：领域级复合得分
 
每个层级应用适当的权重向量和映射函数，确保评估层级间的一致缩放 [model_score_cal_main.py#L8-L14]。
 
## 错误处理与验证
 
问卷处理系统包含全面的验证机制：
 
- **索引验证**：检查所有问题索引是否在有效范围内 [question_2.py#L15-L19]
- **响应验证**：确保有足够的单选题用于总表单计算 [question_2.py#L23-L26]
- **数据一致性**：验证输入格式并优雅处理边界情况
 
<CgxTip>
处理问卷时，确保至少存在一个单选题以建立基准响应总数。系统使用此值标准化所有评分计算。</CgxTip>
 
## 使用示例
 
### 基本模块得分计算
 
```python
from question_2 import calculate_final_scores, SECTION_INDICES
 
# 输入：每个问题选项的响应计数
questionnaire_counts = [
    [2, 3],        # 单选题：选项A有2个，选项B有3个
    [1, 0, 3, 1],  # 多选题：选项A,B,C,D分别有1,0,3,1个
    # ... 更多问题
]
 
# 计算模块得分
scores = calculate_final_scores(questionnaire_counts, SECTION_INDICES)
print(f"模块得分: {scores}")
````

### 与权重方法集成

```python
from eval import eval_qa
from weight_calc_method import bwm_method, entropy_method
 
# 完整评估流程
results = eval_qa(
    questionnaire_1_counts,
    questionnaire_2_counts,
    q1_section_1,
    q1_section_2, 
    level1_names,
    level2_names,
    level3_names,
    SECTION_INDICES,
    method="bwm"  # 或 "entropy"
)
```

问卷处理方法组件为数据成熟度评估提供了坚实基础，使组织能够通过科学验证的评分算法和层次化评估框架，将调查响应转化为可操作的见解。

如需深入了解相关组件，请探索[权重计算算法](深入探讨/核心评估引擎/权重计算方法) 和[基于模块的评分系统](深入探讨/数据处理工具/基于模块的评分系统) 。